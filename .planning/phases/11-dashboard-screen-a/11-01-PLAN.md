# Plan 11-01: Create Dashboard Sub-Components (StatPills, PersonaPillRow, RecentListsPreview)

---
wave: 1
depends_on: []
files_modified:
  - src/components/dashboard/stat-pills.tsx
  - src/components/dashboard/persona-pill-row.tsx
  - src/components/dashboard/recent-lists-preview.tsx
autonomous: true
requirements: [ANLY-01, ANLY-02, ANLY-04, UI-01, UI-04]
---

## Goal

Create three Server Component-compatible sub-components for the tenant dashboard: StatPills (muted horizontal pill row of analytics totals), PersonaPillRow (scrollable persona pill grid linking to search), and RecentListsPreview (compact list of recent lists with member counts). These are presentational components that receive data as props — no client-side fetching.

## must_haves

- `StatPills` renders a horizontal `flex flex-wrap` row of muted stat pills (NOT full stat cards)
- StatPills shows: Searches, Profiles Viewed, Enrichments, Exports (at minimum)
- StatPills uses `var(--bg-elevated)`, `var(--border-subtle)`, `var(--gold-primary)` for values, `var(--text-secondary)` for labels
- StatPills value uses `font-mono` class for number rendering
- `PersonaPillRow` renders up to 8 persona pills as Links to `/${orgId}/search?persona=${persona.id}`
- PersonaPillRow shows a "+ N more" pill linking to `/${orgId}/personas` when count exceeds 8
- PersonaPillRow pills use `rounded-full`, `var(--bg-elevated)`, `var(--border-subtle)`, `var(--text-secondary)` at rest
- PersonaPillRow pills use onMouseEnter/onMouseLeave handlers for hover states (not Tailwind hover: with CSS variables)
- `RecentListsPreview` renders up to 5 recent lists with name, member count, and updated_at
- RecentListsPreview includes a "View All" link to `/${orgId}/lists`
- All components use CSS variables only — zero raw Tailwind color classes (zinc-*, gray-*, yellow-*)
- No emojis used as icons — Lucide only
- No scale transforms on hover — border/opacity transitions only
- `font-serif` used for section headings (not font-cormorant)
- All components are typed with explicit interfaces

## Tasks

<task id="11-01-T1">
<title>Create StatPills component</title>
<description>
Create `src/components/dashboard/stat-pills.tsx`:

1. Define the props interface:
```typescript
interface StatPillsProps {
  totals: {
    totalLogins: number;
    searchesExecuted: number;
    profilesViewed: number;
    profilesEnriched: number;
    csvExports: number;
    listsCreated: number;
  };
}
```

2. Define the pill data array (same metric keys as MetricsCards for consistency):
```typescript
const STAT_ITEMS: { key: keyof StatPillsProps["totals"]; label: string }[] = [
  { key: "searchesExecuted", label: "Searches" },
  { key: "profilesViewed", label: "Profiles Viewed" },
  { key: "profilesEnriched", label: "Enrichments" },
  { key: "csvExports", label: "Exports" },
  { key: "listsCreated", label: "Lists" },
];
```

3. Render as a `flex flex-wrap gap-2` container. Each pill:
```tsx
<div
  key={label}
  className="inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-xs"
  style={{
    background: "var(--bg-elevated)",
    border: "1px solid var(--border-subtle)",
    color: "var(--text-secondary)",
  }}
>
  <span className="font-mono" style={{ color: "var(--gold-primary)" }}>
    {value.toLocaleString()}
  </span>
  <span>{label}</span>
</div>
```

4. Export as a named export: `export function StatPills({ totals }: StatPillsProps)`.

5. This is a Server Component — do NOT add "use client" directive.
</description>
</task>

<task id="11-01-T2">
<title>Create PersonaPillRow component</title>
<description>
Create `src/components/dashboard/persona-pill-row.tsx`:

1. This MUST be a client component — add `"use client";` at the top because it uses onMouseEnter/onMouseLeave handlers for CSS variable hover states.

2. Import `Link` from `next/link` and `{ Users }` from `lucide-react`.

3. Import the Persona type: `import type { Persona } from "@/lib/personas/types";`

4. Define the props interface:
```typescript
interface PersonaPillRowProps {
  personas: Persona[];
  orgId: string;
}
```

5. Constants:
```typescript
const MAX_VISIBLE = 8;
```

6. Component logic:
```typescript
export function PersonaPillRow({ personas, orgId }: PersonaPillRowProps) {
  const visible = personas.slice(0, MAX_VISIBLE);
  const remaining = personas.length - MAX_VISIBLE;

  return (
    <div>
      <h3
        className="font-serif text-[22px] font-semibold mb-4"
        style={{ color: "var(--text-primary)" }}
      >
        Target Personas
      </h3>
      <div className="flex flex-wrap gap-2">
        {visible.map((persona) => (
          <Link
            key={persona.id}
            href={`/${orgId}/search?persona=${persona.id}`}
            className="inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-sm cursor-pointer transition-colors"
            style={{
              background: "var(--bg-elevated)",
              border: "1px solid var(--border-subtle)",
              color: "var(--text-secondary)",
            }}
            onMouseEnter={(e) => {
              e.currentTarget.style.borderColor = "var(--border-hover)";
              e.currentTarget.style.color = "var(--text-primary)";
            }}
            onMouseLeave={(e) => {
              e.currentTarget.style.borderColor = "var(--border-subtle)";
              e.currentTarget.style.color = "var(--text-secondary)";
            }}
          >
            <Users className="h-3.5 w-3.5 shrink-0" />
            {persona.name}
          </Link>
        ))}
        {remaining > 0 && (
          <Link
            href={`/${orgId}/personas`}
            className="inline-flex items-center px-3 py-1.5 rounded-full text-sm cursor-pointer transition-colors"
            style={{
              background: "var(--gold-bg)",
              border: "1px solid var(--border-gold)",
              color: "var(--gold-text)",
            }}
            onMouseEnter={(e) => {
              e.currentTarget.style.background = "var(--gold-bg-strong)";
            }}
            onMouseLeave={(e) => {
              e.currentTarget.style.background = "var(--gold-bg)";
            }}
          >
            +{remaining} more
          </Link>
        )}
      </div>
    </div>
  );
}
```

7. If `personas.length === 0`, render the `EmptyState` component:
```tsx
import { EmptyState } from "@/components/ui/empty-state";

if (personas.length === 0) {
  return (
    <EmptyState
      icon={Users}
      title="No personas yet"
      description="Create personas to start finding high-net-worth prospects"
    />
  );
}
```
</description>
</task>

<task id="11-01-T3">
<title>Create RecentListsPreview component</title>
<description>
Create `src/components/dashboard/recent-lists-preview.tsx`:

1. This MUST be a client component — add `"use client";` at the top because it uses onMouseEnter/onMouseLeave handlers for hover states.

2. Import `Link` from `next/link`, `{ List as ListIcon, ArrowRight }` from `lucide-react`.

3. Import the List type: `import type { List } from "@/lib/lists/types";`

4. Define props:
```typescript
interface RecentListsPreviewProps {
  lists: List[];
  orgId: string;
}
```

5. Component:
```typescript
const MAX_LISTS = 5;

export function RecentListsPreview({ lists, orgId }: RecentListsPreviewProps) {
  const recent = lists.slice(0, MAX_LISTS);

  if (recent.length === 0) {
    return null; // Don't render section if no lists
  }

  return (
    <div>
      <div className="flex items-center justify-between mb-4">
        <h3
          className="font-serif text-[22px] font-semibold"
          style={{ color: "var(--text-primary)" }}
        >
          Recent Lists
        </h3>
        <Link
          href={`/${orgId}/lists`}
          className="inline-flex items-center gap-1 text-xs cursor-pointer transition-colors"
          style={{ color: "var(--text-secondary)" }}
          onMouseEnter={(e) => {
            e.currentTarget.style.color = "var(--gold-primary)";
          }}
          onMouseLeave={(e) => {
            e.currentTarget.style.color = "var(--text-secondary)";
          }}
        >
          View All
          <ArrowRight className="h-3 w-3 shrink-0" />
        </Link>
      </div>
      <div className="space-y-1">
        {recent.map((list) => (
          <Link
            key={list.id}
            href={`/${orgId}/lists/${list.id}`}
            className="flex items-center gap-3 rounded-[8px] px-3 py-2.5 cursor-pointer transition-colors"
            style={{
              background: "transparent",
              color: "var(--text-primary)",
            }}
            onMouseEnter={(e) => {
              e.currentTarget.style.background = "var(--bg-elevated)";
            }}
            onMouseLeave={(e) => {
              e.currentTarget.style.background = "transparent";
            }}
          >
            <ListIcon
              className="h-4 w-4 shrink-0"
              style={{ color: "var(--text-secondary)" }}
            />
            <span className="flex-1 text-sm truncate">{list.name}</span>
            <span
              className="text-xs font-mono"
              style={{ color: "var(--text-tertiary)" }}
            >
              {list.member_count} {list.member_count === 1 ? "prospect" : "prospects"}
            </span>
          </Link>
        ))}
      </div>
    </div>
  );
}
```

6. The `relativeTime` formatting for `updated_at` is NOT needed here — keep the preview minimal with just name + count. The full list page has timestamps.
</description>
</task>

## Verification

- All three files exist in `src/components/dashboard/`
- `pnpm build` passes with no TypeScript errors
- StatPills accepts `totals` prop with the correct shape from analytics API
- PersonaPillRow accepts `personas: Persona[]` and `orgId: string`
- PersonaPillRow renders EmptyState when personas array is empty
- RecentListsPreview accepts `lists: List[]` and `orgId: string`
- RecentListsPreview returns null when lists array is empty
- No raw Tailwind color classes (grep for `zinc-`, `gray-`, `yellow-`, `emerald-`)
- No emojis used anywhere
- No `font-cormorant` class used (only `font-serif`)
- All interactive elements have `cursor-pointer`
