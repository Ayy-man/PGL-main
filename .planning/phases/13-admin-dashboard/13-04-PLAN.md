# Plan 13-04: Build Verification + Design System Compliance Audit

---
phase: 13-admin-dashboard
plan: 04
type: execute
wave: 3
depends_on: [13-01, 13-02, 13-03]
files_modified: []
autonomous: true
requirements: [SA-01, SA-02, SA-03, SA-04, SA-05, ANLY-03]

must_haves:
  truths:
    - "pnpm build passes clean with no TypeScript errors"
    - "All 14 design system compliance items verified against actual source code"
    - "No raw Tailwind color classes in admin component table headers, borders, or text"
    - "ApiQuotaCard replaces ComingSoonCard in PlatformPulse — no 'Coming Soon' overlay"
    - "'Platform Control' section header present in admin nav"
    - "Page h1 matches MASTER.md h1 spec (38px, font-medium, -0.5px tracking)"
    - "All 6 admin API endpoints fetchable from admin page.tsx"
  artifacts: []
  key_links: []
---

<objective>
Run a final build verification and design system compliance audit across all Phase 13 changes. This is a read-only verification plan — no code changes unless a build error or compliance failure is found.

Purpose: Confirm that all 3 prior plans integrated correctly, no regressions introduced, and the full design system compliance checklist passes.

Output: Verified build + compliance audit results.
</objective>

<execution_context>
@/Users/aymanbaig/.claude/get-shit-done/workflows/execute-plan.md
@/Users/aymanbaig/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/phases/13-admin-dashboard/13-RESEARCH.md
@design-system/MASTER.md
@design-system/pages/dashboard.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Run pnpm build and verify clean output</name>
  <files></files>
  <action>
Run `pnpm build` in the project root. Verify:

1. Build completes with exit code 0
2. No TypeScript errors
3. No import resolution errors
4. `img-element` warnings are pre-existing linting warnings (not errors) — acceptable
5. "Dynamic server usage" messages for cookie-using API routes are expected and informational — acceptable

If the build fails:
- Read the error message carefully
- Fix the specific file causing the failure
- Re-run build to confirm fix

Expected: Clean build. The prior 3 plans each verified their own build, so this should pass.
  </action>
  <verify>
    <automated>cd /Users/aymanbaig/Desktop/Manual\ Library/Phronesis-main && pnpm build 2>&1 | tail -30</automated>
  </verify>
  <done>
    - `pnpm build` exits with code 0
    - No TypeScript errors in output
    - No import resolution failures
  </done>
</task>

<task type="auto">
  <name>Task 2: Design system compliance audit — verify all 14 items against source code</name>
  <files></files>
  <action>
Read each admin component file and verify the 14 compliance items from the research checklist. This is a READ-ONLY task — do not modify files unless a compliance failure is found.

**Audit checklist (verify against actual source):**

1. **Stat card values** — Read `platform-pulse.tsx`. Verify StatCard uses `font-serif font-bold` at `fontSize: "36px"`, gold for non-zero, `var(--text-secondary)` for zero.

2. **Labels** — Read all admin components. Verify all label `<p>` elements use `text-xs font-semibold uppercase tracking-wider` with `var(--admin-text-secondary)`.

3. **Card containers** — Verify all cards use `surface-admin-card` class, not manual `bg-` classes.

4. **Section headings** — Read `page.tsx`. Verify section h2 elements use `font-serif text-xl font-semibold mb-4 admin-section-heading`.

5. **Table headers** — Read `tenant-heatmap.tsx` and `error-feed.tsx`. Verify `text-[11px] font-semibold uppercase tracking-wider` with `var(--admin-text-secondary)`.

6. **Table row borders** — Verify `var(--admin-row-border)` used, not raw Tailwind `border-white/*`.

7. **Table row hover** — Verify `admin-row-hover` class on interactive rows.

8. **Table thead** — Verify `admin-thead` class on thead rows.

9. **Chart tooltips** — Read `enrichment-health-chart.tsx` and `funnel-chart.tsx`. Verify `backgroundColor: "var(--card)"`, `border: "1px solid var(--border)"`, `borderRadius: "8px"`.

10. **Empty states** — Verify centered muted text for no-data conditions.

11. **No raw Tailwind color classes** — Search for `text-white/`, `bg-white/` in admin components. `bg-white/[0.06]` in skeleton shimmer is acceptable. `text-white/*` for primary text is NOT acceptable.

12. **Icons** — Verify all icons are `h-4 w-4 shrink-0` from Lucide.

13. **No scale transforms** — Verify no `scale-`, `hover:scale-` classes.

14. **Page fade-in** — Verify `page-enter` class is applied (via layout.tsx wrapper).

**Additional Phase 13 specific checks:**

15. **ApiQuotaCard** — Verify it replaces ComingSoonCard in PlatformPulse. No "Coming Soon" overlay.

16. **Platform Control header** — Verify section label present in admin-nav-links.tsx.

17. **H1 typography** — Verify page h1 uses `fontSize: "38px"`, `font-medium`, `letterSpacing: "-0.5px"`.

18. **Quota API route** — Verify `src/app/api/admin/quota/route.ts` exists with GET export and `force-dynamic`.

19. **Admin page fetches 6 endpoints** — Verify page.tsx fetchAll includes `/api/admin/quota`.

If any item fails: fix the specific file and re-verify.

Record results in the SUMMARY.md.
  </action>
  <verify>
    <automated>cd /Users/aymanbaig/Desktop/Manual\ Library/Phronesis-main && echo "=== Check 1: No ComingSoonCard in platform-pulse ===" && grep -c "ComingSoonCard" src/components/admin/platform-pulse.tsx || echo "PASS: 0 occurrences" && echo "=== Check 2: ApiQuotaCard present ===" && grep -c "ApiQuotaCard" src/components/admin/platform-pulse.tsx && echo "=== Check 3: Platform Control label ===" && grep -c "Platform Control" src/app/admin/admin-nav-links.tsx && echo "=== Check 4: Quota route exists ===" && test -f src/app/api/admin/quota/route.ts && echo "PASS" || echo "FAIL" && echo "=== Check 5: Quota fetch in page ===" && grep -c "api/admin/quota" src/app/admin/page.tsx && echo "=== Check 6: No text-sm in chart labels ===" && grep -c "text-sm font-medium" src/components/admin/enrichment-health-chart.tsx src/components/admin/funnel-chart.tsx || echo "PASS: 0 occurrences"</automated>
  </verify>
  <done>
    - All 19 compliance items verified against actual source code
    - No regressions from prior plans
    - Build passes clean
    - Audit results documented in SUMMARY.md
  </done>
</task>

</tasks>

<verification>
- `pnpm build` exits 0
- All 14 design system compliance items pass
- All 5 Phase 13 specific checks pass
- No raw Tailwind color classes in admin table elements
- ApiQuotaCard renders in PlatformPulse (no ComingSoonCard)
- "Platform Control" section header in admin nav
- H1 matches MASTER.md spec
- Quota API route exists and is fetched
</verification>

<success_criteria>
- `pnpm build` passes clean
- 19/19 compliance audit items pass
- Phase 13 declared complete — ready for Phase 14 (Polish + Verification)
</success_criteria>

<output>
After completion, create `.planning/phases/13-admin-dashboard/13-04-SUMMARY.md`
</output>
