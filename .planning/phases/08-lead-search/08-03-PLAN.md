---
phase: 08-lead-search
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - src/app/[orgId]/search/components/bulk-actions-bar.tsx
  - src/app/[orgId]/search/components/prospect-result-card.tsx
autonomous: true
requirements: [SRCH-03, PROF-01, PROF-09, LIST-03]

must_haves:
  truths:
    - "BulkActionsBar shows select-all checkbox, count label, and action buttons when items selected"
    - "ProspectResultCard shows checkbox when onSelect provided and fires onClick for slide-over"
    - "ProspectResultCard imports shared WealthTierBadge from @/components/ui/ (not local copy)"
  artifacts:
    - path: "src/app/[orgId]/search/components/bulk-actions-bar.tsx"
      provides: "Bulk actions toolbar with select-all, Add to List, Export CSV, Enrich Selection"
      exports: ["BulkActionsBar"]
    - path: "src/app/[orgId]/search/components/prospect-result-card.tsx"
      provides: "Updated result card with checkbox support and slide-over click"
      exports: ["ProspectResultCard"]
  key_links:
    - from: "bulk-actions-bar.tsx"
      to: "parent (SearchContent)"
      via: "onSelectAll, onAddToList, onExport callbacks"
      pattern: "onSelectAll|onAddToList|onExport"
    - from: "prospect-result-card.tsx"
      to: "@/components/ui/wealth-tier-badge"
      via: "import (replacing local copy)"
      pattern: "from.*@/components/ui/wealth-tier-badge"
---

<objective>
Create the BulkActionsBar component and update ProspectResultCard with checkbox support and proper imports.

Purpose: BulkActionsBar enables power-user bulk workflows (select-all, add to list, export). ProspectResultCard update eliminates component duplication and adds checkbox for bulk selection.
Output: BulkActionsBar component, updated ProspectResultCard with checkbox and shared WealthTierBadge import
</objective>

<execution_context>
@/Users/aymanbaig/.claude/get-shit-done/workflows/execute-plan.md
@/Users/aymanbaig/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/phases/08-lead-search/08-RESEARCH.md
@design-system/MASTER.md
@design-system/pages/search.md

<interfaces>
<!-- Types and contracts from existing code -->

From src/lib/apollo/types.ts:
```typescript
export interface ApolloPerson {
  id: string;
  first_name: string;
  last_name: string;
  name: string;
  title: string;
  headline?: string;
  organization_name?: string;
  city?: string;
  state?: string;
  country?: string;
  email?: string;
  email_status?: string;
  phone_numbers?: ApolloPhoneNumber[];
  linkedin_url?: string;
}
```

From src/components/ui/wealth-tier-badge.tsx (Phase 6 shared):
```typescript
// Accepts tier: string | null | undefined
export function WealthTierBadge({ tier }: { tier: string | null | undefined });
```

From src/lib/lists/types.ts:
```typescript
export interface List {
  id: string;
  tenant_id: string;
  name: string;
  description: string | null;
  member_count: number;
  created_at: string;
  updated_at: string;
}
```

From src/app/[orgId]/search/components/add-to-list-dialog.tsx:
```typescript
interface AddToListDialogProps {
  prospect: ApolloPerson;
  lists: List[];
  trigger: React.ReactNode;
  orgId: string;
}
export function AddToListDialog({ prospect, lists, trigger, orgId }: AddToListDialogProps);
```
</interfaces>
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create BulkActionsBar component</name>
  <files>src/app/[orgId]/search/components/bulk-actions-bar.tsx</files>
  <action>
  Create `src/app/[orgId]/search/components/bulk-actions-bar.tsx`:

  1. "use client" directive at top.

  2. Import: `ListPlus`, `Download`, `Sparkles` from lucide-react; `Button` from `@/components/ui/button`.

  3. Props interface:
     ```typescript
     interface BulkActionsBarProps {
       selectedCount: number;
       totalCount: number;
       allSelected: boolean;
       onSelectAll: () => void;
       onAddToList: () => void;
       onExport: () => void;
       onEnrich: () => void;
     }
     ```

  4. Component renders a bar that appears above results:
     Container:
     ```
     className="flex items-center justify-between rounded-[10px] px-4 py-3 mb-3"
     style={{ background: "var(--bg-elevated)", border: "1px solid var(--border-default)" }}
     ```

  5. Left side: checkbox + label
     - Native `<input type="checkbox">` with `checked={allSelected}`, `onChange={onSelectAll}`.
       ```
       className="h-4 w-4 rounded cursor-pointer accent-[var(--gold-primary)]"
       aria-label="Select all prospects"
       ```
     - Label span:
       ```
       className="text-[13px]"
       style={{ color: "var(--text-secondary-ds)" }}
       ```
       Text: `selectedCount > 0 ? "${selectedCount} selected" : "Select All"`

  6. Right side: action buttons (only visible when selectedCount > 0):
     Container: `flex items-center gap-2`
     - "Add to List" button: `Button variant="ghost" size="sm"`, `ListPlus` icon h-4 w-4 mr-1.5
     - "Export CSV" button: `Button variant="ghost" size="sm"`, `Download` icon h-4 w-4 mr-1.5
     - "Enrich Selection" button: `Button variant="gold" size="sm"`, `Sparkles` icon h-4 w-4 mr-1.5

  IMPORTANT: Buttons use `variant="ghost"` and `variant="gold"` from the existing Button component (already has these variants). No raw color classes.
  </action>
  <verify>
    <automated>cd /Users/aymanbaig/Desktop/Manual\ Library/Phronesis-main && test -f src/app/\[orgId\]/search/components/bulk-actions-bar.tsx && grep -c "BulkActionsBar" src/app/\[orgId\]/search/components/bulk-actions-bar.tsx && grep -c "onSelectAll" src/app/\[orgId\]/search/components/bulk-actions-bar.tsx && grep -c "Sparkles" src/app/\[orgId\]/search/components/bulk-actions-bar.tsx</automated>
  </verify>
  <done>BulkActionsBar renders select-all checkbox with count label, three action buttons (Add to List, Export CSV, Enrich Selection) with correct icons and button variants</done>
</task>

<task type="auto">
  <name>Task 2: Update ProspectResultCard — add checkbox, fix imports, wire onClick for slide-over</name>
  <files>src/app/[orgId]/search/components/prospect-result-card.tsx</files>
  <action>
  Modify the existing `src/app/[orgId]/search/components/prospect-result-card.tsx`:

  1. **Fix WealthTierBadge import:** Change from:
     ```typescript
     import { WealthTierBadge } from "./wealth-tier-badge";
     ```
     To:
     ```typescript
     import { WealthTierBadge } from "@/components/ui/wealth-tier-badge";
     ```
     This uses the canonical Phase 6 shared component instead of the local duplicate.

  2. **Add checkbox support.** Extend the props interface:
     ```typescript
     interface ProspectResultCardProps {
       prospect: ApolloPerson;
       lists: List[];
       orgId: string;
       onClick: () => void;
       selected?: boolean;        // NEW
       onSelect?: () => void;     // NEW
     }
     ```

  3. **Add checkbox element.** At the beginning of the left section (before the avatar), conditionally render a checkbox when `onSelect` is provided:
     ```tsx
     {onSelect && (
       <div className="flex items-center pt-1">
         <input
           type="checkbox"
           checked={selected}
           onChange={(e) => {
             e.stopPropagation();
             onSelect();
           }}
           onClick={(e) => e.stopPropagation()}
           className="h-4 w-4 rounded border-border accent-[var(--gold-primary)] cursor-pointer"
           aria-label={`Select ${name}`}
         />
       </div>
     )}
     ```

  4. **Update selected visual state.** When `selected` is true, use gold background/border (same pattern as shared ProspectCard):
     ```typescript
     style={{
       background: selected ? "var(--gold-bg)" : (isHovered ? "var(--bg-card-hover)" : "var(--bg-card-gradient)"),
       border: selected
         ? "1px solid var(--border-gold)"
         : (isHovered ? "1px solid var(--border-hover)" : "1px solid var(--border-subtle)"),
     }}
     ```

  5. Keep everything else the same — the existing hover state, avatar gradient, contact circles, AI insight block, AddToListDialog are all correct and design-system compliant.

  IMPORTANT: Do NOT replace the entire component with ProspectCard — keep the existing ProspectResultCard but fix imports and add checkbox. The component already follows the design system closely.
  </action>
  <verify>
    <automated>cd /Users/aymanbaig/Desktop/Manual\ Library/Phronesis-main && grep -c "@/components/ui/wealth-tier-badge" src/app/\[orgId\]/search/components/prospect-result-card.tsx && grep -c "onSelect" src/app/\[orgId\]/search/components/prospect-result-card.tsx && grep -c "selected" src/app/\[orgId\]/search/components/prospect-result-card.tsx</automated>
  </verify>
  <done>ProspectResultCard imports shared WealthTierBadge, renders checkbox when onSelect provided, shows gold selected state, onClick still fires for slide-over trigger</done>
</task>

</tasks>

<verification>
- `test -f src/app/[orgId]/search/components/bulk-actions-bar.tsx` passes
- `grep "@/components/ui/wealth-tier-badge" src/app/[orgId]/search/components/prospect-result-card.tsx` returns a match (no local import)
- `grep "onSelect" src/app/[orgId]/search/components/prospect-result-card.tsx` returns 2+ matches
- No raw Tailwind color classes in either file
</verification>

<success_criteria>
1. BulkActionsBar renders with select-all, count, and 3 action buttons using design system button variants
2. ProspectResultCard uses shared WealthTierBadge import (not local duplicate)
3. ProspectResultCard shows checkbox when onSelect provided, highlights when selected
4. Both components are standalone and ready for wiring in Plan 04
</success_criteria>

<output>
After completion, create `.planning/phases/08-lead-search/08-03-SUMMARY.md`
</output>
