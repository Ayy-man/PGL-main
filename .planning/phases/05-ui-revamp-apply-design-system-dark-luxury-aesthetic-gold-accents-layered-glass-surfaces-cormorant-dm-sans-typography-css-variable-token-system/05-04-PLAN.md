---
phase: 05-ui-revamp
plan: 04
type: execute
wave: 3
depends_on: ["05-01", "05-02"]
files_modified:
  - src/app/[orgId]/search/page.tsx
  - src/app/[orgId]/search/components/search-content.tsx
  - src/app/[orgId]/search/components/persona-selector.tsx
  - src/app/[orgId]/search/components/search-results-table.tsx
  - src/app/[orgId]/search/components/persona-card.tsx
  - src/app/[orgId]/search/components/prospect-result-card.tsx
  - src/app/[orgId]/search/components/wealth-tier-badge.tsx
autonomous: true
requirements:
  - SRCH-02
  - SRCH-03
  - SRCH-05
must_haves:
  truths:
    - "Persona selection shows a card grid (not dropdown) with Cormorant names, gold corner accent, and Search CTA"
    - "Search results display as vertical card stack (not data table) with prospect avatars and contact icons"
    - "Wealth tier badges show graduated gold intensity based on tier level"
    - "Clicking a prospect card is wired to open prospect detail (slide-over in Plan 06)"
    - "useSearch hook and URL state management remain completely unchanged"
    - "Create Persona card has dashed border with centered gold + icon"
  artifacts:
    - path: "src/app/[orgId]/search/components/persona-card.tsx"
      provides: "Persona selection card with Cormorant name, gold corner accent, title tags"
      min_lines: 40
    - path: "src/app/[orgId]/search/components/prospect-result-card.tsx"
      provides: "Horizontal prospect card with avatar, contact icons, wealth badge"
      min_lines: 60
    - path: "src/app/[orgId]/search/components/wealth-tier-badge.tsx"
      provides: "Graduated gold badges for wealth tiers"
      min_lines: 20
  key_links:
    - from: "src/app/[orgId]/search/components/search-content.tsx"
      to: "src/app/[orgId]/search/components/persona-card.tsx"
      via: "SearchContent renders PersonaCard grid when no persona selected"
      pattern: "PersonaCard"
    - from: "src/app/[orgId]/search/components/search-content.tsx"
      to: "src/app/[orgId]/search/components/prospect-result-card.tsx"
      via: "SearchContent renders ProspectResultCard stack when results exist"
      pattern: "ProspectResultCard"
---

<objective>
Rebuild the search page from dropdown+table to persona card grid + prospect result card stack per the search.md page override spec.

Purpose: The search page is the most-used page in the application. The card-based layout provides richer visual hierarchy for persona selection and prospect scanning compared to the current dropdown+table pattern.

Output: Three new components (PersonaCard, ProspectResultCard, WealthTierBadge), updated SearchContent orchestrator, persona selector refactored to card grid.
</objective>

<execution_context>
@/Users/aymanbaig/.claude/get-shit-done/workflows/execute-plan.md
@/Users/aymanbaig/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@design-system/MASTER.md
@design-system/pages/search.md
@src/app/[orgId]/search/page.tsx
@src/app/[orgId]/search/components/search-content.tsx
@src/app/[orgId]/search/components/persona-selector.tsx
@src/app/[orgId]/search/components/search-results-table.tsx
@src/app/[orgId]/search/hooks/useSearch.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create PersonaCard, ProspectResultCard, and WealthTierBadge components</name>
  <files>src/app/[orgId]/search/components/persona-card.tsx, src/app/[orgId]/search/components/prospect-result-card.tsx, src/app/[orgId]/search/components/wealth-tier-badge.tsx</files>
  <action>
**Create WealthTierBadge (src/app/[orgId]/search/components/wealth-tier-badge.tsx):**

Per search.md "Wealth Tier Badges" section. This uses raw rgba intentionally (approved exception to the no-inline-hex rule):

```tsx
type WealthTier = "$500M+" | "$100M+" | "$50M+" | "$30M+";

const TIER_STYLES: Record<WealthTier, { bg: string; border: string; text: string }> = {
  "$500M+": { bg: "rgba(212,175,55,0.25)", border: "rgba(212,175,55,0.6)", text: "#f0d060" },
  "$100M+": { bg: "rgba(212,175,55,0.15)", border: "rgba(212,175,55,0.4)", text: "#d4af37" },
  "$50M+":  { bg: "rgba(212,175,55,0.08)", border: "rgba(212,175,55,0.25)", text: "#c4a030" },
  "$30M+":  { bg: "rgba(212,175,55,0.05)", border: "rgba(212,175,55,0.15)", text: "#a08828" },
};

export function WealthTierBadge({ tier }: { tier: WealthTier }) {
  const s = TIER_STYLES[tier];
  if (!s) return null;
  return (
    <span
      className="inline-flex items-center rounded-full text-[11px] font-semibold px-2.5 py-0.5"
      style={{ background: s.bg, border: `1px solid ${s.border}`, color: s.text }}
    >
      {tier}
    </span>
  );
}
```

**Create PersonaCard (src/app/[orgId]/search/components/persona-card.tsx):**

Per search.md "Persona Cards" section:
- Container: `button` element, `rounded-[14px] p-7 text-left transition-all duration-200 cursor-pointer overflow-hidden relative`
- Background: `style={{ background: "var(--bg-card-gradient)", border: "1px solid var(--border-subtle)" }}`
- Hover: Use onMouseEnter/Leave to swap `background` to `var(--bg-card-hover)` and `borderColor` to `rgba(212,175,55,0.3)`
- Corner gold accent: Absolute positioned div `top-0 right-0 w-32 h-32 pointer-events-none` with `radial-gradient(circle at top right, rgba(212,175,55,0.06) 0%, transparent 70%)`
- Name: `font-serif text-[22px] font-semibold text-foreground leading-tight`
- Inline "Starter" badge if persona.is_starter: `text-[10px] uppercase tracking-wider text-[var(--gold-text)] ml-2`
- Description: `text-[13px] font-light text-muted-foreground mt-2`
- Title tags: `flex flex-wrap gap-1.5 mt-4`, each tag: `text-[11px] px-2.5 py-1 rounded-[6px]` with `style={{ background: "var(--bg-elevated)", border: "1px solid var(--border-default)" }}`
- Footer row: `mt-6 flex items-center justify-between`
  - Left: `~X,XXX matches` in `text-xs text-muted-foreground`
  - Right: `Search →` in `text-sm font-medium text-[var(--gold-primary)]`
- Props: `persona: Persona` (import from existing types), `onSelect: (id: string) => void`

**Create a "Create Persona" card variant** either as a separate component or conditional render:
- Dashed border: `border border-dashed border-muted-foreground/30`
- No solid background or corner accent
- Centered: 48px circle with `+` rendered in gold, `text-[24px] font-semibold`
- "Create Persona" label: `text-sm font-medium text-foreground`
- Subtitle: `text-xs text-muted-foreground/50` "Custom filter combination"

**Create ProspectResultCard (src/app/[orgId]/search/components/prospect-result-card.tsx):**

Per search.md "Prospect Result Cards" section:
- Container: `rounded-[12px] p-6 px-7 flex items-start justify-between transition-all duration-200 cursor-pointer`
- Background/border: `style={{ background: "var(--bg-card-gradient)", border: "1px solid var(--border-subtle)" }}`
- Hover: swap to `var(--bg-card-hover)` and `var(--border-hover)`

Left section (flex row, gap-[18px]):
1. **Avatar**: 48px circle, generate hue-derived gradient from name hash:
   ```tsx
   const hue = name.split('').reduce((acc, c) => acc + c.charCodeAt(0), 0) % 360;
   style={{ background: `linear-gradient(135deg, hsl(${hue}, 40%, 30%), hsl(${hue}, 50%, 20%))` }}
   ```
   Initials in `font-serif text-[18px] text-white/80`

2. **Info block**:
   - Name: `font-serif text-[20px] font-semibold text-foreground` + WealthTierBadge inline
   - Title + Company: `text-[13px] text-muted-foreground` joined with ` · `
   - Location: `text-xs text-muted-foreground/60 mt-0.5`
   - AI Insight block (if available): `mt-3 pl-3 py-2` with `style={{ borderLeft: "2px solid var(--border-gold)", background: "var(--gold-bg)" }}`
     - "AI INSIGHT" label: `text-[10px] uppercase tracking-wider font-semibold` in `text-[var(--gold-text)]`
     - Body: `text-xs text-foreground/80 mt-1`

Right section (flex col, gap-3, items-end):
1. **Contact icons**: Row of 28px circles, `gap-2`
   - Each: `h-7 w-7 rounded-full flex items-center justify-center`
   - Available: `style={{ background: "var(--gold-bg)", border: "1px solid var(--border-gold)" }}`, icon in `text-[var(--gold-primary)]`
   - Unavailable: `bg-muted border border-border`, icon in `text-muted-foreground/40`
   - Icons: Mail, Phone, Linkedin from lucide-react, each `h-3.5 w-3.5`
2. **"+ Add to List" button**: Use Button component with `variant="gold" size="sm"`, text: `+ Add to List`

Props: Accept prospect data object from the existing search results shape. Also accept `onClick` for opening slide-over and `onAddToList` callback.
  </action>
  <verify>
    <automated>cd "/Users/aymanbaig/Desktop/Manual Library/Phronesis-main" && test -f "src/app/[orgId]/search/components/persona-card.tsx" && test -f "src/app/[orgId]/search/components/prospect-result-card.tsx" && test -f "src/app/[orgId]/search/components/wealth-tier-badge.tsx" && echo "PASS: All 3 new components exist" || echo "FAIL"</automated>
  </verify>
  <done>PersonaCard with Cormorant name, gold corner accent, and title tags. ProspectResultCard with avatar, contact icons, wealth badge, and AI insight block. WealthTierBadge with graduated gold intensity. All three components created.</done>
</task>

<task type="auto">
  <name>Task 2: Rewire SearchContent to render persona card grid and result card stack</name>
  <files>src/app/[orgId]/search/page.tsx, src/app/[orgId]/search/components/search-content.tsx, src/app/[orgId]/search/components/persona-selector.tsx</files>
  <action>
**CRITICAL: Do NOT modify the useSearch hook, URL state management (nuqs), or add-to-list-dialog.tsx. Only change the rendering layer.**

**Update search-content.tsx:**

The SearchContent component currently orchestrates: persona selection state, search trigger, results rendering. Update the rendering logic:

1. **When no persona is selected (default state):**
   Replace the PersonaSelector dropdown with the persona card grid:
   ```tsx
   {/* Page header */}
   <div className="mb-12">
     <h1 className="font-serif text-[38px] font-medium text-foreground" style={{ letterSpacing: "-0.5px" }}>
       Find Prospects
     </h1>
     <p className="mt-2 text-sm font-light text-muted-foreground/60">
       Select a persona to discover matching prospects
     </p>
   </div>

   {/* Persona card grid */}
   <div className="grid gap-5" style={{ gridTemplateColumns: "repeat(auto-fill, minmax(340px, 1fr))" }}>
     {personas.map(persona => (
       <PersonaCard key={persona.id} persona={persona} onSelect={handlePersonaSelect} />
     ))}
     <CreatePersonaCard onPress={() => router.push(`/${orgId}/personas/new`)} />
   </div>
   ```

2. **When results are showing:**
   Replace SearchResultsTable with ProspectResultCard stack:
   ```tsx
   {/* Results header */}
   <div className="mb-8">
     <button onClick={handleBackToPersonas} className="text-xs text-[var(--gold-muted)] hover:text-[var(--gold-primary)] transition-colors cursor-pointer mb-4">
       ← Back to personas
     </button>
     <div className="flex items-center justify-between">
       <div>
         <h1 className="font-serif text-[34px] font-medium text-foreground">{selectedPersona?.name}</h1>
         <p className="text-sm text-muted-foreground mt-1">{selectedPersona?.description} · {totalResults} results</p>
       </div>
       <div className="flex gap-3">
         <Button variant="ghost" size="sm">Filters</Button>
         <Button variant="gold" size="sm">Export CSV</Button>
       </div>
     </div>
   </div>

   {/* Prospect result card stack */}
   <div className="flex flex-col gap-3">
     {results.map(prospect => (
       <ProspectResultCard
         key={prospect.id}
         prospect={prospect}
         onClick={() => handleProspectClick(prospect.id)}
         onAddToList={() => handleAddToList(prospect)}
       />
     ))}
   </div>

   {/* Keep existing pagination logic */}
   ```

3. **Keep the existing state management:** `useSearch` hook call, pagination handling, loading/error states. Only change what gets rendered.

4. **Loading state:** When searching, show skeleton cards (3-4 placeholder cards with pulse animation) instead of skeleton table rows.

5. **Empty state:** Use the updated EmptyState component with Search icon.

**Update persona-selector.tsx:**
This component may no longer be needed as a dropdown. If search-content.tsx now renders the card grid directly, persona-selector.tsx can be left as-is (not deleted) for backward compatibility, but search-content.tsx should import PersonaCard directly.

**Update page.tsx** if needed:
Ensure the page wrapper has no conflicting styles. The search page should inherit the shell layout from [orgId]/layout.tsx.
  </action>
  <verify>
    <automated>cd "/Users/aymanbaig/Desktop/Manual Library/Phronesis-main" && grep -q "PersonaCard\|persona-card" "src/app/[orgId]/search/components/search-content.tsx" && grep -q "ProspectResultCard\|prospect-result-card" "src/app/[orgId]/search/components/search-content.tsx" && echo "PASS" || echo "FAIL"</automated>
  </verify>
  <done>SearchContent renders PersonaCard grid for persona selection and ProspectResultCard stack for results. useSearch hook, URL state, and pagination remain unchanged. Back-to-personas navigation works. Loading shows skeleton cards.</done>
</task>

</tasks>

<verification>
1. PersonaCard, ProspectResultCard, WealthTierBadge files exist with correct exports
2. search-content.tsx imports and renders PersonaCard grid (no more dropdown selector)
3. search-content.tsx imports and renders ProspectResultCard stack (no more data table for search results)
4. useSearch hook is not modified
5. URL state management (nuqs) still works — persona selection updates URL
6. Pagination remains functional
7. `npx next build` compiles without errors
</verification>

<success_criteria>
- Persona selection: card grid with 340px min columns, 20px gap, Cormorant names, gold corner accent
- Create Persona: dashed border card with centered gold + icon
- Prospect results: vertical card stack with 48px avatars, contact icon circles, wealth tier badges
- AI insight blocks display with gold left border when data available
- Back-to-personas navigation works
- Search flow end-to-end: select persona -> results load -> cards render -> pagination works
</success_criteria>

<output>
After completion, create `.planning/phases/05-ui-revamp-apply-design-system-dark-luxury-aesthetic-gold-accents-layered-glass-surfaces-cormorant-dm-sans-typography-css-variable-token-system/05-04-SUMMARY.md`
</output>
